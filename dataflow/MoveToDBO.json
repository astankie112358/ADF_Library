{
	"name": "MoveToDBO",
	"properties": {
		"type": "MappingDataFlow",
		"typeProperties": {
			"sources": [
				{
					"dataset": {
						"referenceName": "AzureDBOConnection",
						"type": "DatasetReference"
					},
					"name": "StagingTable"
				}
			],
			"sinks": [
				{
					"dataset": {
						"referenceName": "AzureDBOConnection",
						"type": "DatasetReference"
					},
					"name": "DBOTable"
				}
			],
			"transformations": [],
			"scriptLines": [
				"source(output(",
				"          ID as integer,",
				"          Name as string,",
				"          Date_Added as timestamp",
				"     ),",
				"     allowSchemaDrift: true,",
				"     validateSchema: false,",
				"     isolationLevel: 'READ_UNCOMMITTED',",
				"     format: 'table') ~> StagingTable",
				"StagingTable sink(allowSchemaDrift: true,",
				"     validateSchema: false,",
				"     input(",
				"          ID as integer,",
				"          Name as string,",
				"          Date_Added as timestamp",
				"     ),",
				"     deletable:false,",
				"     insertable:true,",
				"     updateable:false,",
				"     upsertable:false,",
				"     format: 'table',",
				"     skipDuplicateMapInputs: true,",
				"     skipDuplicateMapOutputs: true,",
				"     errorHandlingOption: 'stopOnFirstError',",
				"     mapColumn(",
				"          IDNOSNIK = CopyId,",
				"          IDWYPO = RentalId,",
				"          KWOTA = TotalAmount,",
				"          ILE_NOSNIKOW = CopiesCount,",
				"          DATAZ = ReturnDate,",
				"          DATAW = RentalDate,",
				"          IDKLIENT = Rental_CustomerId,",
				"          IDWYPO = RentalDetail_RentalId,",
				"          IDNOSNIK = RentalDetail_CopyId,",
				"          STATUS = Status,",
				"          IDFILM = Copy_MovieId,",
				"          IDRODZAJ = GenreId,",
				"          IDFILM = MovieGenre_MovieId,",
				"          IDKRAJ = CountryId,",
				"          IDFILM = MovieCountry_MovieId,",
				"          OPIS = Description,",
				"          CZAS_TRWANIA = DurationMin,",
				"          KOLOR = IsColor,",
				"          CENA = RentalPrice,",
				"          IDREZYSER = DirectorId,",
				"          TYTUL = Title,",
				"          IDFILM = MovieId,",
				"          PLEC = Gender,",
				"          TELEFON = Phone,",
				"          ADRES = Address,",
				"          WIEK = Age,",
				"          IMIE = CustomerFirstName,",
				"          NAZWISKO = CustomerLastName,",
				"          IDKLIENT = CustomerId,",
				"          RODZAJFIL = GenreName,",
				"          IDRODZAJ = GenreId,",
				"          IMIE = DirectorFirstName,",
				"          NAZWISKO = DirectorLastName,",
				"          IDREZYSER = DirectorId,",
				"          KRAJPROD = CountryName,",
				"          IDKRAJ = CountryId",
				"     )) ~> DBOTable"
			]
		}
	}
}